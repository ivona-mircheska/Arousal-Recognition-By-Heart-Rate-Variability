Arousal as a common emotion represents a crucial role in understanding daily human reaction towards different events and situations. Determining the level of arousal by heart rate variability is a very complicated task. Adding to this point, trying to invoke arousal in people, taking into account the challenging environment in today’s society toughens the matter. Our research involves two approaches in resolving the issue, classification and regression for analysing different arousal values in participants wearing a mask with sensors for detecting facial muscle activity, exposed to certain type of video materials. The outcome showed that obtaining high results in predicting is impossible when the participant is tested in a calming area without particular movement and not enough effective videos. Comparing classification and regression, it is safely to say that classification brought more satisfactory results.
Understanding the core principle of arousal may lead to new revolutionary discoveries in the field of science and medicine, and also to help researchers in diagnosing cardiovascular problems and possible mental health issues. Through the individual’s reactions to different stimuli, like blushing, dilating pupils, sudden facial movements and increased breathing and heart rate, scientists can establish a thorough understanding of the human psyche.There are many research papers that assess the task of recognising arousal through heart rate variability analysis.Physiological variation of the interval between consecutive heartbeats is known as the heart rate variability (HRV). HRV analysis is traditionally performed on electrocardiograms (ECG signals) and has become a useful tool in the diagnosis of different clinical and functional conditions.Electrocardiogram (ECG) signals represent the electrical activity of the human hearts and consist of several waveforms. The duration and shape of each waveform and the distances between different peaks are used to diagnose heart diseases. The mask used in this research contains sensors that capture these signals from the two frontalis muscles and the single corrugator muscle in order to extract heart rate variability features used in this machine learning study.

The main challenge faced in this process is how to accurately estimate the exact value of arousal that the participant experienced during the recordings since there were a lot of present data anomalies.

Subjects recruitment, experimental protocol and attributes

Thirty healthy volunteers between the ages of 16 and 23, most of them at the age of 21, were involved in the experiment. Participants did not suffer from any cardiovascular, psychological and neurological diseases, and were aware of the purpose of the experiment. During the entire experiment the subjects were in a resting state, constantly wearing the mask with sensors. The arousal sessions included 20 videos (happy, sad, uncomfortable) displayed in different order for every participant. The role of the participant was to give a score (from 1 to 9) for the arousal that was caused whilst watching the certain video. The features were extracted every 30 seconds with a window slide of 10 seconds. 
The total amount of heart rate variability features was 38. Some of the extracted features were the following:
-	Mean heart rate as provided by the mask
- Interbeat intervals – period between two consecutive heart beats
- Standard deviation of NN intervals - standard deviation of the IBI of normal sinus beats (SDNN) measured in milliseconds 
-	Standard deviation of successive RR interval differences - standard deviation of the IBIs for all sinus beats (SDRR), including abnormal or false beats, measured in milliseconds

Statistical analysis and visualization

The participants were divided in train, validation and test sets. The train set had twenty participants, while validation and test had five participants. We approached solving this problem with classification using three classes (low, medium and high) and regression with nine classes (all the scores 1-9). 
The statistical distribution of the classes (low, medium, high) in each of the sets (train, validation and test) is quite similar. Most present class in the entire data set is the low class, and least present is the high class which indicates that big part of the participants had low arousal from watching the videos.
Comparing each attribute with the density of the classes, it is certain that there is inability to make a distinction between the three. For each attribute and for each of their most appeared values among the participants, the density of distribution of all three classes is concentrated around those values. This is the main reason as to why the attributes have a very low information gain. Out off all the attributes, median_ibi has the highest information gain which is 0.11, although, generally speaking it is clear that this value is quite low. 
Since every participant has different, individual set of values for the HRV attributes, it was necessary to perform normalization of the data set. The case was observed with baseline and minmax normalization.
During the watching process, there was a baseline session where the subjects watched a calming video without the intention to cause any arousal. In this session the baseline features were extracted, later used for the baseline normalization. For each feature vector of the baseline data set, the mean value was calculated and then subtracted from the actual value of the appropriate feature from the main data set. This was performed for each participant separately.
Looking over the distribution of the classes with respect to mean heart rate, attribute used mostly as an example for comparison, even after the performed baseline normalization, there was not any ability to distinct the classes. Plus, although mean heart rate is expected to give us a better insight, this shows that it is an invaluable attribute for the case.
Min-max normalization is one of the most common ways to normalize data. For every feature, the minimum value of that feature gets transformed into a 0, the maximum value gets transformed into a 1, and every other value gets transformed into a decimal between 0 and 1.


Arousal Classification

In general, for all three cases, without normalization, baseline normalization and minmax normalization, we used five algorithms: Decision Tree, Random Forest, Support Vector Machine (SVM), AdaBoost and Extreme Gradient Boosting (XGBoost). For analysing the results after building the models we used accuracy and fscore (macro) as metrics. Accuracy represents the percentage of the correctly classified instances, while macro fscore is computed using the arithmetic mean (aka unweighted mean) of all the per-class fscores. In the case of no normalization, the accuracy reached 55% for SVM model, while the fscore reached 32% for AdaBoost. In the case of baseline normalization we received similar results, having the highest accuracy for SVM (51%) and highest fscore for AdaBoost (34%). And lastly, in the case of minmax normalization, AdaBoost has the highest accuracy (45%) and the highest fscore (35%).
According to both accuracy (50%) and fscore (31%), Decision Tree showed most satisfactory results, which is why undersampling was performed for this model. Undersampling refers to a group of techniques designed to balance the class distribution for a classification dataset that has a skewed class distribution.The type of undersampling used for this research is Condensed Nearest Neighbours (CNN). Condensed Nearest Neighbors, or CNN for short, is an undersampling technique that seeks a subset of a collection of samples that results in no loss in model performance, referred to as a minimal consistent set. It is achieved by enumerating the examples in the dataset and adding them to the “store” only if they cannot be classified correctly by the current contents of the store. After performing the undersampling the results were: accuracy 45% and fscore 36%.


Arousal Regression

Compared to classification, regression gives significantly worse results. For regression, mean absolute error (MAE), mean squared error (MSE), root mean squared error (RMSE) and coefficient of determination (R2 score) are used as metrics.The statistical distribution of the classes (scores 1-9) in each of the sets (train, validation and test) is quite similar. Most present class in the entire data set is the score 1, and least present is the score 9 from watching the videos.In the case of no normalization the best regressor was Decision Tree Regressor (MAE=1.99, MSE=5.46, RMSE=2.34, R2=-0.00). In the case of baseline normalization the best regressor was AdaBoost Regressor (MAE=1.94, MSE=5.48, RMSE=2.34, R2=-0.00). In the case of minmax normalization the best regressor was AdaBoost Regressor (MAE=2.17, MSE=6.83, RMSE=2.61, R2=-0.25). For a model to be considered as good, R2 score need to be 0.9 and above. Since in our case the values are quite low, it clearly shows that regression is not a good choice for solving this problem.

Experimental Results

Classification gave more better results compared to regression. Highest accuracy (55%) was accomplished in the case of no normalization in the SVM model where the fscore was low (23%). This is due to the fact that all instances are classified as low (the class that is mostly present) because the model does not distinguish the classes. So according to this, SVM should not be considered as a good model. In this case, AdaBoost can be considered as a better model, because it has much higher fscore (32%) and mildly good accuracy (41%) compared to SVM. Highest fscore (36%) was accomplished in the case of baseline normalization in the Decision Tree model with undersampling. With undersampling, the distribution of classes becomes even and that also causes increasement of fscore, because fscore always takes in regard whether the classes are evenly distributed. Taking everything in regard, Decision Tree with baseline normalization and undersampling is the best model for solving this problem with the type of data set used in this research.


In this study, various approaches based on HRV analysis were proposed to understand and address the problem, though the results were not particularly high. The method for obtaining feature vectors had limitations.
Firstly, the video material lacked content capable of inducing a high level of arousal. Secondly, higher arousal might be achieved by testing subjects in a dynamic environment, such as through movement or virtual reality, to better capture and directly expose them to stimuli. Lastly, the level of arousal is influenced by each subject’s current emotions, mental state, and mood.
